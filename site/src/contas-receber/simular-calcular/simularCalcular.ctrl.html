<link rel="stylesheet" href="src/contas-receber/simular-calcular/simularCalcular.ctrl.css">

<div class="header">
	<div header></div>
</div>

<div ng-init="ngOnInit()" class="row container-fluid ba__body-content ba__full-width">
	<!--CONTAINER MENU-->
	<div sidebar></div>
	<!--CONTAINER SISTEMA-->
	<div class="col-xs-21 ba__admin-container">
		<!-- INICIO Tela CATEGORIA DE USUÁRIOS-->
		<div class="col-xs-24 ba__admin-container-list">
			<div class="row ba__admin-busca" ng-if="accessPagina.inserir">
				<div class="col-xs-24 input-group ba__admin-busca-input" style="float: left; border: none!important; height: 30px">
					<span class="input-group-addon" style="height: 60px"></span>
					<div class="col-md-6" style="margin-top:10px;">
						<div class="input-group">
							<select class="ba__input-select" ng-model="data.mesSelecionado" ng-change="atualizaMesModelo()" enter ng-options="periodo.mes_competencia+'-'+periodo.ano_competencia as mesExtenso(periodo.mes_competencia)+' - '+periodo.ano_competencia for periodo in data.meses_aprovados">
								<option value=''>SELECIONE O MÊS ESTIMADO</option>
							</select>
						</div>
					</div>
					<button type="button" id="simulacao" class="btn btn-success col-xs-4 uppercase" style="margin-top: 12px; margin-left: -25px" ng-click="simulaCalculo()" disabled>
						 Simulação
					</button>
				</div>
			</div>
			<div class="row" style="margin: 40px 60px 40px 60px">
				<div class="col-md-24">
					<div class="col-md-12">
						<h4 class="text-gray ba__margin-bottom-35">
							<b>Informação para o cálculo</b>
						</h4>
						<div class="col-md-10">
							<h5 class="text-gray">
								<b>Área Total</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.area_total | number}} m²</h5>
						</div>
						<div class="col-md-10">
							<h5 class="text-gray">
								<b>Tipo de apuração</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.tipo_apuracao}}</h5>
						</div>
						<div class="col-md-10">
							<h5 class="text-gray">
								<b>Data de vencimento</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.data_vencimento}}</h5>
						</div>
						<div class="col-md-10">
							<h5 class="text-gray">
								<b>Total de imóveis</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.total_imoveis}} imóveis</h5>
						</div>
						<div class="col-md-10">
							<h5 class="text-gray">
								<b>Percentual de juros ao mês</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.percentual_juros}}%</h5>
						</div>
						<div class="col-md-10">
							<h5 class="text-gray">
								<b>Percentual de multa</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.percentual_multa}}%</h5>
						</div>
						<div class="col-md-10">
							<h5 class="text-gray">
								<b>Percentual de fundo de reserva</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.percentual_fundo_reserva}}%</h5>
						</div>
						<!--<div class="col-md-12">-->
						<!--<h5 class="text-gray"><b>Escopo da apuração</b></h5>-->
						<!--</div>-->
						<!--<div class="col-md-12">-->
						<!--<h5>Realizado</h5>-->
						<!--</div>-->

						<!--<div class="col-md-12">-->
						<!--<h5 class="text-gray"><b>Data final de apuração</b></h5>-->
						<!--</div>-->
						<!--<div class="col-md-12">-->
						<!--<h5>20/11/2017</h5>-->
						<!--</div>-->
					</div>
					<div class="col-md-12">
						<h4 class="text-gray ba__margin-bottom-35">
							<b>Informação receitas</b>
						</h4>
						<div class="col-md-12">
							<h5 class="text-gray">
								<b>Despesas com fundo de reserva</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{(data.infoCalculo.despesa_total.despesas_com_fundo | currency) || 0}}</h5>
						</div>
						<div class="col-md-12">
							<h5 class="text-gray">
								<b>Despesas sem fundo de reserva</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{(data.infoCalculo.despesa_total.despesas_sem_fundo | currency) || 0}}</h5>
						</div>
						<div class="col-md-12">
							<h5 class="text-gray">
								<b>Valor do fundo reserva</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{(data.infoCalculo.despesa_total.fundo_reserva | currency) || 0}}</h5>
						</div>
						<div class="col-md-12">
							<h5 class="text-gray">
								<b>Rateio (fração ideal) (R$/m²)</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{(data.infoCalculo.fracao_ideal.valor_rateio_m2 | currency) || 0}}</h5>
						</div>
						<div class="col-md-12">
							<h5 class="text-gray">
								<b>Rateio do fundo de reserva (R$/m²)</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{(data.infoCalculo.fracao_ideal.valor_rateio_fundo | currency) || 0}}</h5>
						</div>
						<div class="col-md-12">
							<h5 class="text-gray">
								<b>Carteira</b>
							</h5>
						</div>
						<div class="col-md-12">
							<h5>{{data.infoCalculo.carteira}}</h5>
						</div>
					</div>
				</div>
				<!--<div class="col-md-8">-->
				<!--<h4 class="text-gray ba__margin-bottom-35"><b>Despesas estimadas</b></h4>-->
				<!--<div ng-repeat="lancamentoEstimado in data.lancamentoEstimadosByGroup">-->
				<!--<div class="col-md-12">-->
				<!--<h5 class="text-gray"><b>{{lancamentoEstimado[0].grupo_lancamento.descricao}}</b></h5>-->
				<!--</div>-->
				<!--<div class="col-md-12">-->
				<!--<h5>{{ getSumByGroup(lancamentoEstimado) | currency}}</h5>-->
				<!--</div>-->
				<!--</div>-->
				<!--</div>-->
			</div>
			<div class="row ba__admin-list" style="height: 340px">
				<div class="list-group ba__admin-table">
					<a class="list-group-item disabled">
						<div class="row uppercase">
							<div class="col-xs-2">Código
								<i class="ba__margin-horizontal-5"></i>
							</div>
							<div class="col-xs-4">Data do Cálculo
								<i class="ba__margin-horizontal-5"></i>
							</div>
							<div class="col-xs-4">Data do vencimento
								<i class="ba__margin-horizontal-5"></i>
							</div>
							<div class="col-xs-7">Área total
								<i class="ba__margin-horizontal-5"></i>
							</div>
							<div class="col-xs-5">Total de despesas apurado
								<i class="ba__margin-horizontal-5"></i>
							</div>
							<div class="col-xs-2">Ações
								<i class="ba__margin-horizontal-5"></i>
							</div>
						</div>
					</a>
					<div class="ba__admin-table-scroll" style="overflow-y: auto;height: 82%;">
						<a class="list-group-item ba__font-size-12" ng-repeat="calculo in data.calculos">
							<div class="row">
								<div class="col-xs-2">{{calculo.id}}</div>
								<div class="col-xs-4">{{calculo.data_calculo}}</div>
								<div class="col-xs-4">{{calculo.data_vencimento}}</div>
								<div class="col-xs-7">{{calculo.area_total_apurada | number}} m²</div>
								<div class="col-xs-5">{{calculo.total_despesas_apurada | currency:'R$ '}}</div>
								<div class="col-xs-2">
									<i class="fa fa-download" title="Download da remessa" ng-click="downloadRemessa(calculo)"></i>
									<i class="fa fa-print ba__margin-left-15" title="Visualizar boletos" ng-click="visualizaBoletos(calculo)"></i>
									<i class="fa fa-envelope ba__margin-left-15" title="Enviar por e-mail" ng-click="sendBoletoCalculoEmail(calculo)"></i>
								</div>
							</div>
						</a>
					</div>
					<div class="col-md-10 col-md-offset-9" ng-if="pageCount">
						<nav class="">
							<ul class="pagination text-center" style="margin:inherit">
								<li>
									<a aria-label="Previous" ng-click="updateList(current_page - 1)" class="ba__margin-right-15">
										<span aria-hidden="true">&laquo; ANTERIOR</span>
									</a>
								</li>
								<li ng-click="updateList(page)" ng-repeat="page in pages">
									<a ng-class="page == current_page ? 'selected' : ''">{{page}}</a>
								</li>
								<li ng-if="pageCount > 5">
									<a>...</a>
								</li>
								<li ng-if="pageCount > 5" ng-click="updateList(pageCount)">
									<a ng-class="pageCount == current_page ? 'selected' : ''">{{pageCount}}</a>
								</li>
								<li>
									<a aria-label="Next" ng-click="updateList(current_page + 1)" style="margin-left: 15px">
										<span aria-hidden="true">PRÓXIMA &raquo;</span>
									</a>
								</li>
							</ul>
						</nav>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!--MODAL SIMULAÇÃO DO CÁLCULO DA RECEITA-->
<div class="modal fade" id="simulacaoReceita" role="dialog" data-backdrop="static">
	<div class="modal-dialog ba__modal-simulacao-calculo" role="document">
		<div class="modal-content" style="height: 700px">
			<div class="modal-header ba__no-padding-top">
				<h4 class="col-xs-21 modal-title Roboto-Thin ba__font-size-25">
					<i class="icon-ba-attention text-center text-primary ba__margin-horizontal-5"></i>
					<span>Simulação do cálculo da receita</span>
					<!--<span>Editando tipo de lançamento</span>-->
				</h4>
			</div>
			<div class="modal-body ba__modal-body-tipo-lancamento ba__margin-top-7" style="overflow: hidden">
				<div class="row">
					<div class="col-md-24">
						<div class="col-md-12">
							<div class="col-md-12">
								<h5 class="text-gray">
									<b>Data do cálculo</b>
								</h5>
							</div>
							<div class="col-md-12">
								<h5>{{data.simulacao.dataCalculo}}</h5>
							</div>

							<div class="col-md-12">
								<h5 class="text-gray">
									<b>Data de vencimento</b>
								</h5>
							</div>
							<div class="col-md-12">
								<h5>{{data.simulacao.dataVencimento}}</h5>
							</div>

							<div class="col-md-12">
								<h5 class="text-gray">
									<b>Qtd boletos</b>
								</h5>
							</div>
							<div class="col-md-12">
								<h5>{{qtdList}}</h5>
							</div>
						</div>
						<div class="col-md-12">
							<div class="col-md-12">
								<h5 class="text-gray">
									<b>Despesa estimada</b>
								</h5>
							</div>
							<div class="col-md-12">
								<h5>{{data.simulacao.despesaEstimada | currency}}</h5>
							</div>
							<div class="col-md-12">
								<h5 class="text-gray">
									<b>Fundo de reserva</b>
								</h5>
							</div>
							<div class="col-md-12">
								<h5>{{data.simulacao.fundoDeReserva | currency}}</h5>
							</div>
							<div class="col-md-12">
								<h5 class="text-gray">
									<b>Despesa Outros</b>
								</h5>
							</div>
							<div class="col-md-12">
								<h5>{{data.simulacao.despesaTotalOutros | currency}}</h5>
							</div>
							<div class="col-md-12">
								<h5 class="text-gray">
									<b>Despesa Geral total</b>
								</h5>
							</div>
							<div class="col-md-12">
								<h5>{{data.simulacao.despesaGeralTotal | currency}}</h5>
							</div>

							<!--<div class="col-md-12" ng-show="false">
								<h5 class="text-gray"><b>Fórmua de cálculo aplicada</b></h5>
							</div>
							<div class="col-md-12" ng-show="false">
								<h5>{{data.simulacao.formulaAplicada}}</h5>
							</div>-->
						</div>
					</div>
				</div>

				<div class="row ba__admin-list">
					<div class="list-group ba__admin-table ba__margin-top-20 col-md-24" style="height: 65%;">
						<a class="list-group-item disabled col-md-24">
							<div class="row uppercase">
								<div class="col-xs-1">Num
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-1">Quadra
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-1">Lote
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-8">Parceiro
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-3">Área do imóvel
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-3">Taxa associativa
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-3">Fundo de Reserva
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-2">Outros
									<i class="ba__margin-horizontal-5"></i>
								</div>
								<div class="col-xs-2">Valor total
									<i class="ba__margin-horizontal-5"></i>
								</div>
							</div>
						</a>
						<div class="ba__admin-table-scroll col-md-24 ba__padding-top-20" style="overflow: auto;height: 90%">
							<a class="list-group-item ba__font-size-12" ng-repeat="simulacaoLancamento in data.simulacaolist.lancamentos">
								<div class="row">
									<div class="col-xs-1">
										<b>{{$index+1}}</b>
									</div>
									<div class="col-xs-1">
										<b>{{simulacaoLancamento.quadra}}</b>
									</div>
									<div class="col-xs-1">
										<b>{{simulacaoLancamento.lote}}</b>
									</div>
									<div class="col-xs-8">
										<b>{{simulacaoLancamento.nome}}</b>
									</div>
									<div class="col-xs-3">
										<b>{{simulacaoLancamento.area_imovel}} m²</b>
									</div>
									<div class="col-xs-3">
										<b>{{simulacaoLancamento.valor_taxa | currency}}</b>
									</div>
									<div class="col-xs-3">
										<b>{{simulacaoLancamento.fundo_reserva | currency}}</b>
									</div>
									<div class="col-xs-2">
										<b>{{simulacaoLancamento.outros | currency}}</b>
									</div>
									<div class="col-xs-2">
										<b>{{simulacaoLancamento.taxa_associativa | currency}}</b>
									</div>
								</div>
							</a>
						</div>
					</div>

					<!--<div class="col-md-14 col-md-offset-6" style="margin-top: -15px">-->
					<!--<nav class="">-->
					<!--<ul class="pagination text-center">-->
					<!--<li>-->
					<!--<a  aria-label="Previous" class="ba__margin-right-15">-->
					<!--<span aria-hidden="true">&laquo; ANTERIOR</span>-->
					<!--</a>-->
					<!--</li>-->
					<!--<li><a >1</a></li>-->
					<!--<li><a >2</a></li>-->
					<!--<li><a >3</a></li>-->
					<!--<li><a >4</a></li>-->
					<!--<li><a >5</a></li>-->
					<!--<li>-->
					<!--<a  aria-label="Next" style="margin-left: 15px">-->
					<!--<span aria-hidden="true">PRÓXIMA &raquo;</span>-->
					<!--</a>-->
					<!--</li>-->
					<!--</ul>-->
					<!--</nav>-->
					<!--</div>-->
				</div>
			</div>

			<div class="modal-footer" style="padding: 0; padding-top: 25px">

				<button type="button" class="btn btn-default col-md-6 col-md-offset-10" ng-click="closeSimulacaoModal()">
					Cancelar simulação
				</button>
				<button type="button" class="btn btn-success col-md-6 col-md-offset-1" ng-click="checkSimulacao()">
					Aprovar simulação
				</button>
			</div>
		</div>
	</div>
</div>

<!--MODAL CHECKLIST-->
<div class="modal fade" id="checkSimulacao" role="dialog" data-backdrop="static">
	<div class="modal-dialog ba__modal-novo-equipamento" role="document">
		<div class="modal-content" style="height: 700px">
			<div class="modal-header ba__no-padding-top">
				<h4 class="col-xs-21 modal-title Roboto-Thin ba__font-size-25">
					<i class="icon-ba-attention text-center text-primary ba__margin-horizontal-5"></i>
					<span>Checklist</span>
					<!--<span>Editando tipo de lançamento</span>-->
				</h4>
			</div>
			<div class="modal-body ba__modal-body-tipo-lancamento">
				<form>
					<div class="row">
						<h5 class="text-gray">
							<b>Para que a geração tenha um resultado efetivo, devemos validar:</b>
						</h5>
						<div class="form-group col-xs-24 ba__margin-top-20">
							<div class="row">
								<h5 class="col-xs-15">• O nome do condomínio;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Checar o CNPJ;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Os e-mails de agendamento;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Os valores de despesa;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• O total geral de área dos imóveis juntamente com a sua quantidade;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Percentual de fundo de reserva;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Validar o percentual de multas e juros</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Periodicidade de juros;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Validar regras de cálculo</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Fração ideal;</h5>
							</div>
							<div class="row">
								<h5 class="col-xs-15">• Validar o escopo do nosso número;</h5>
							</div>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer" style="padding: 0; padding-top: 25px">
				<button type="button" class="btn btn-default btn-clear col-md-6 col-md-offset-4" style="margin-left: 95px" ng-click="closeCheckSimulacao()">
					Cancelar
				</button>
				<button ng-disabled="btnSimuEna" type="button" type="submit" class="btn btn-success col-md-6 col-md-push-2" ng-click="aprovaCalculo()">
					Confirmar
				</button>
			</div>
		</div>
	</div>
</div>

<!--MODAL CALCULANDO-->
<div class="modal fade" id="loading" role="dialog" data-backdrop="static">
	<div class="modal-dialog ba__modal-loading" role="document">
		<div class="modal-content">
			<div class="modal-header ba__no-padding-top">
				<h4 class="col-xs-21 modal-title Roboto-Thin ba__font-size-25">
					<i class="icon-ba-attention text-center text-warning ba__margin-horizontal-5"></i>
					<span>{{loadObj.title}}</span>
				</h4>
			</div>
			<div class="modal-body ba__modal-body-loading">
				<form>
					<div class="row ba__margin-top-30">
						<i class="col-md-5 fa fa-spinner fa-spin ba__font-size-80 text-center"></i>
						<h5 class="col-md-19 text-gray ba__margin-top-20">
							<b>{{loadObj.body}}</b>
						</h5>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

<!-- MODAL DE ALERTA -->
<div class="modal fade" id="modalAlerta" role="dialog" data-backdrop="static">
	<div class="modal-dialog ba__modal-novo-equipamento" role="document">
		<div class="modal-content" style="height: 700px">
			<div class="modal-header ba__no-padding-top">
				<h4 class="col-xs-21 modal-title Roboto-Thin ba__font-size-25">
					<i class="icon-ba-attention text-center text-primary ba__margin-horizontal-5"></i>
					<span>ATENÇÃO </span>
				</h4>
			</div>
			<div class="modal-body ba__modal-body-tipo-lancamento">
				<ng-bind-html ng-bind-html="modalAlerta"></ng-bind-html>
			</div>
			<div class="modal-footer" style="padding: 0; padding-top: 25px">
				<button data-dismiss="modal" ng-click="print()" type="button" class="btn btn-default btn-clear col-md-6 col-md-offset-4"
				  style="margin-left: 95px">
					Imprimir
				</button>
				<button ng-click="$('#modalAlerta').modal('hide')" ng-disabled="btnSimuEna" type="button" type="submit" class="btn btn-success col-md-6 col-md-push-2">
					Fechar
				</button>
			</div>
		</div>
	</div>
</div>

<!--MODAL GERANDO REMESSA-->
<div class="modal fade" id="loading-gerar_remessa" role="dialog" data-backdrop="static">
	<div class="modal-dialog ba__modal-loading" role="document">
		<div class="modal-content">
			<div class="modal-header ba__no-padding-top">
				<h4 class="col-xs-21 modal-title Roboto-Thin ba__font-size-25">
					<i class="icon-ba-attention text-center text-warning ba__margin-horizontal-5"></i>
					<span>Download arquivo de remessa</span>
				</h4>
			</div>
			<div class="modal-body ba__modal-body-loading">
				<form>
					<div class="row ba__margin-top-30">
						<i class="col-md-5 fa fa-spinner fa-spin ba__font-size-80 text-center"></i>
						<h5 class="col-md-19 text-gray ba__margin-top-20">
							<b>Carregando...</b>
						</h5>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
<!--MODAL PDF-->
<div class="modal fade relatorio-modal" id="showPdf" tabindex="-1" role="dialog" data-backdrop="static"
	 data-keyboard="false">
	<h1 data-dismiss="modal">X</h1>
	<object data="{{content}}" type="application/pdf"></object>
</div>
<!--MODAL PDF-->
<!--MODAL LOADING-->
<div class="modal" id="waiting" role="dialog" data-backdrop="static" style="background: rgba(0, 0, 0, 0.1)!important">
    <div class="modal-dialog" role="document">
        <div style="padding: 20px;background:#FFF;width:14%;margin: 15% auto;position: relative;background-clip: padding-box;text-align: center;">
            <div class="row">
                <i class="col-md-5 fa fa-spinner fa-spin ba__font-size-50 text-center"></i>
                <h5 class="col-md-13 col-md-offset-1 text-gray ba__margin-top-20">
                    <b>aguarde...</b>
                </h5>
            </div>
        </div>
    </div>
</div>