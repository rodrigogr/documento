<link rel='stylesheet' href='src/patrimonio/patrimonio.css'>
<div class="header">
    <div header></div>
</div>
<div class='patrimonio'>
    <section class='main'>
        <div class='container-fluid'>
            <div ng-init='init()' class='row'>
                <nav sidebar></nav>

                <div class='col-xs-21 content'>
                    <form action='' method='post' class='form-horizontal filter'>
                        <div class='row'>
                            <label class='control-label col-xs-2' for='filter'>Pesquisar</label>
                            <div class='col-xs-22'>
                                <input class='form-control' ng-model='data.filter.value'>
                            </div>
                        </div>
                    </form>

                    <div class='result-action'>
                        <h3 ng-if='(data.rows | filter:data.filter.value).length == 1'><strong>1</strong> baixa encontrada</h3>
                        <h3 ng-if='(data.rows | filter:data.filter.value).length != 1'><strong>{{(data.rows | filter:data.filter.value).length}}</strong> baixas encontradas</h3>
                        <button data-toggle='modal' ng-click='newRow()' ng-if="accessPagina.inserir" type='button' class='btn btn-success'>Nova baixa de patrimônio</button>
                    </div>

                    <div class='list-group'>
                        <a class='list-group-item disabled'>
                            <div class='row uppercase'>
                                <div class='col-xs-4'>Nº do patrimônio</div>
                                <div class='col-xs-2'>Data</div>
                                <div class='col-xs-12'>Produto</div>
                                <div class='col-xs-2'>Tipo</div>
                                <div class='col-xs-2'>Valor</div>
                                <div class='col-xs-2 acoes'>Ações</div>
                            </div>
                        </a>

                        <a href='#' class='list-group-item' ng-repeat='row in (data.rows | filter:data.filter.value)' ng-click='editRow($event, row)'>
                            <div class='row'>
                                <div class='col-xs-4'>{{row.patrimonio.numero}}</div>
                                <div class='col-xs-2'>{{mDateSrv.isoToDateObj(row.data).toLocaleString('pt-BR', {'timeZone':'America/Sao_Paulo'}).substr(0, 10)}}</div>
                                <div class='col-xs-12'>{{row.patrimonio.produto.descricao}}</div>
                                <div class='col-xs-2'>{{row.tipo}}</div>
                                <div class='col-xs-2'>{{row.valor.toLocaleString('arab', {'style':'currency', 'currency':'BRL'})}}</div>
                                <div class='col-xs-2 acoes'>
                                    <i class='fa fa-eye'></i>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal registrar baixa. -->
    <div class='modal fade' id='registro'>
        <div class='modal-dialog'>
            <form class='form-horizontal modal-content' ng-submit='submit()'>
                <div class='modal-header'>
                    <h4 class='modal-title'>Patrimônio - registro de baixa</h4>
                </div>
                <div class='modal-body'>
                    <fieldset>
                        <div class='row'>
                            <legend class='col-md-6'>Produto</legend>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='numero'>Nº do patrimônio</label>
                            <div class='col-md-18'>
                                <select class='form-control' id='numero' name='numero' required

                                    ng-model='data.patrimonioSelecionado'
                                    ng-options='option as option.numero for option in data.list.patrimonios'

                                    >
                                    <option value=''>selecione...</option>
                                </select>
                            </div>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='produto'>Produto</label>
                            <div class='col-md-18'>
                                <input class='form-control' type='text' id='produto' name='produto' ng-model='data.patrimonioSelecionado.produto.descricao' readonly>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <div class='row'>
                            <legend class='col-md-6'>Baixa</legend>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='data'>Data de baixa</label>
                            <div class='col-md-18'>
                                <input type='date' id='data' name='data' class='form-control' ng-model='data.model.data' required>
                            </div>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='tipo'>Tipo da baixa</label>
                            <div class='col-md-18'>
                                <select class='form-control' name='tipo' id='tipo' ng-model='data.model.tipo' required>
                                    <option value=''>Selecione...</option>
                                    <option value='devolucao' ng-selected='data.model.tipo == "devolucao"'>Devolução</option>
                                    <option value='alienacao' ng-selected='data.model.tipo == "alienacao"'>Alienação</option>
                                    <option value='doacao' ng-selected='data.model.tipo == "doacao"'>Doação</option>
                                    <option value='permuta' ng-selected='data.model.tipo == "permuta"'>Permuta</option>
                                    <option value='inservivel' ng-selected='data.model.tipo == "inservivel"'>Inservível</option>
                                    <option value='sinistro' ng-selected='data.model.tipo == "sinistro"'>Sinistro</option>
                                    <option value='morte' ng-selected='data.model.tipo == "morte"'>Morte</option>
                                    <option value='verificacao' ng-selected='data.model.tipo == "verificacao"'>Verificação</option>
                                    <option value='transferencia' ng-selected='data.model.tipo == "transferencia"'>Transferência</option>
                                    <option value='recadastramento' ng-selected='data.model.tipo == "recadastramento"'>Recadastramento</option>
                                    <option value='desmembramento' ng-selected='data.model.tipo == "desmembramento"'>Desmembramento</option>
                                </select>
                            </div>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='situacao'>Situação</label>
                            <div class='col-md-18'>
                                <select class='form-control' name='situacao' id='situacao' ng-model='data.model.situacao' required>
                                    <option value=''>Selecione...</option>
                                    <option value='em-desuso' ng-selected='data.model.situacao == "em-desuso"'>Em desuso</option>
                                    <option value='obsoleto' ng-selected='data.model.situacao == "obsoleto"'>Obsoleto</option>
                                    <option value='imprestavel' ng-selected='data.model.situacao == "imprestavel"'>Imprestável</option>
                                </select>
                            </div>
                        </div>

                        <div class='form-group' ng-show='["devolucao", "alienacao", "doacao", "permuta", "verificacao", "transferencia"].indexOf(data.model.tipo) > -1'>
                            <label class='control-label col-md-6' for='nota_fiscal_saida'>Nota fiscal de saída</label>
                            <div class='col-md-18'>
                                <input type='text' id='nota_fiscal_saida' name='nota_fiscal_saida' class='form-control' ng-model='data.model.nota_fiscal_saida'>
                                <span>(Opcional)</span>
                            </div>
                        </div>

                        <div class='form-group' ng-show='["devolucao", "alienacao", "doacao", "permuta", "verificacao", "transferencia"].indexOf(data.model.tipo) > -1'>
                            <label class='control-label col-md-6' for='destinatario'>Destinatário</label>
                            <div class='col-md-18'>
                                <input type='text' id='destinatario' name='destinatario' class='form-control' ng-model='data.model.destinatario'>
                                <span>(Opcional)</span>
                            </div>
                        </div>

                        <div class='form-group' ng-show='["devolucao", "alienacao", "doacao", "permuta", "verificacao", "transferencia"].indexOf(data.model.tipo) > -1'>
                            <label class='control-label col-md-6' for='motivo'>Motivo</label>
                            <div class='col-md-18'>
                                <textarea id='motivo' name='motivo' class='form-control' ng-model='data.model.motivo'></textarea>
                                <span>(Opcional)</span>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <div class='row'>
                            <legend class='col-md-6'>Baixa</legend>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='valor_bem'>Valor do bem</label>
                            <div class='col-md-18'>
                                <input id='valor_bem' name='valor_bem' class='form-control' ng-model='data.patrimonioSelecionado.valor' ui-money-mask readonly>
                            </div>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='valor_depreciacao'>Valor da depreciação</label>
                            <div class='col-md-18'>
                                <input type='text' id='valor_depreciacao' name='valor_depreciacao' class='form-control' ng-model='data.patrimonioSelecionado.depreciacao' ui-money-mask readonly>
                            </div>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='valor_atual'>Valor atual</label>
                            <div class='col-md-18'>
                                <input id='valor_atual' name='valor_atual' class='form-control' ng-model='data.patrimonioSelecionado.valorAtual' ui-money-mask readonly>
                            </div>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='valor'>Valor da baixa</label>
                            <div class='col-md-18'>
                                <input id='valor' name='valor' class='form-control' ng-model='data.model.valor' placeholder='R$ 0,00' ui-money-mask required>
                            </div>
                        </div>

                        <div class='form-group'>
                            <label class='control-label col-md-6' for='diferenca_valor'>Diferença de valor</label>
                            <div class='col-md-18'>
                                <input id='diferenca_valor' name='diferenca_valor' class='form-control' ng-model='data.patrimonioSelecionado.valorDiferenca' readonly>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <div class='modal-footer'>
                    <a href='#' class='revogar-baixa' ng-click='openModalRevogacao($event)' ng-if="accessPagina.inserir" ng-show='data.model.id'>Revogar baixa</a>
                    <button type='button' class='btn btn-default' ng-click='closeModal()'>Fechar</button>

                    <button class='btn btn-success' ng-show='!data.model.id'>
                        <span>Registrar</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
    <!-- Modal registrar baixa. -->

    <!-- Modal revogação de baixa. -->
    <div class='modal fade' id='revogacao'>
        <div class='modal-dialog'>
            <form class='form-horizontal modal-content' ng-submit='update()'>
                <div class='modal-header'>
                    <h4 class='modal-title'>Motivo da revogação</h4>
                </div>

                <div class='modal-body'>
                    <div class='form-group'>
                        <label class='control-label col-md-6' for='motivo_revogacao'>Qual o motivo da<br>revogacao da baixa?</label>
                        <div class='col-md-18'>
                            <textarea id='motivo_revogacao' name='motivo_revogacao' class='form-control' ng-model='data.model.motivo_revogacao' required></textarea>
                        </div>
                    </div>
                </div>

                <div class='modal-footer'>
                    <button type='button' class='btn btn-default' ng-click='closeModalRevogacao()'>Não revogar</button>
                    <button class='btn btn-success'>Revogar agora</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Modal revogação de baixa. -->
</div>
