<link rel="stylesheet" href="src/reservas/local-reservavel/localReservavel.ctrl.css">

<div class="header">
    <div header></div>
</div>

<div class="row container-fluid ba__body-content ba__full-width">
    <!--CONTAINER MENU-->
    <div sidebar></div>
    <!--CONTAINER SISTEMA-->
    <div class="col-xs-21 ba__admin-container">
        <!-- INICIO Tela CATEGORIA DE USUÁRIOS-->
        <div class="col-xs-24 ba__admin-container-list">
            <div class="row ba__admin-busca">
                <div class="col-xs-24 input-group ba__admin-busca-input" style="float: left; border: none!important; height: 30px; margin-left: 20px">
                    <span class="input-group-addon" style="height: 60px"></span>
                    <select class="col-xs-3 ba__adminSelectBusca" ng-change="pesquisaChange()" ng-init="search.type = 'nome'" ng-model="search.type"
                            style="height: 50px; border-bottom: 1px solid #cccccc;padding-left: 20px;">
                        <option value="nome">Nome</option>
                    </select>
                    <input type="text" class="col-xs-4 ba__margin-left-15" ng-model="search.nome" style="height: 50px; border-bottom: 1px solid #cccccc;">
                    <button type="button" class="btn btn-primary col-xs-3 col-xs-offset-1 uppercase" style="margin-top: 7px" ng-click="checkData(search) && pesquisar(search)">
                        Pesquisar
                        <i class="icon-ba-search"></i>
                    </button>
                </div>
            </div>

            <div class="row" style="height: auto; margin: 10px 2%">
                <div class="row ba__margin-top-20">
                    <h3 class="col-md-15 Roboto-Light">
                        <strong>{{locais.length || 0}}</strong> Registros encontrados</h3>
                    <button type="button" class="btn btn-success col-xs-offset-3 col-xs-4 uppercase" style="margin-top: 12px"
                            data-toggle="modal" ng-click="createNovoLocal()" ng-if="accessPagina.inserir">
                        Novo Local
                    </button>
                </div>
            </div>

            <div class="ba__admin-table" style="margin: 20px">
                <a class="list-group-item">
                    <div class="row uppercase titulo-lista">
                        <div class="col-xs-1" style="cursor: pointer;" ng-click="sort('id')">Id {{prop=='id'&&(reverse?'⬆':'⬇')||''}}
                            <i class="ba__margin-horizontal-5"></i>
                        </div>
                        <div class="col-xs-5" style="cursor: pointer;" ng-click="sort('descricao')">Descrição {{prop == 'descricao'&&(reverse?'⬆':'⬇')||''}}
                            <i class="ba__margin-horizontal-5"></i>
                        </div>
                        <div class="col-xs-5" style="cursor: pointer;" ng-click="sort('l_fornecedor')">Fornecedor {{prop=='l_fornecedor'&&(reverse?'⬆':'⬇')||''}}
                            <i class="ba__margin-horizontal-5"></i>
                        </div>
                        <div class="col-xs-7" style="cursor: pointer;" ng-click="sort('l_planoConta')">Plano de conta {{prop=='l_planoConta'&&(reverse?'⬆':'⬇')||''}}
                            <i class="ba__margin-horizontal-5"></i>
                        </div>
                        <div class="col-xs-2" style="cursor: pointer;" ng-click="sort('data_base')">Data Origem {{prop=='data_base'&&(reverse?'⬆':'⬇')||''}}
                            <i class="ba__margin-horizontal-5"></i>
                        </div>
                        <!--<div class="col-xs-4 text-center">Localização<i class="ba__margin-horizontal-5"></i></div>-->
                        <div class="col-xs-2" style="cursor: pointer;" ng-click="sort('l_valorTotal')">Valor {{prop == 'l_valorTotal'&&(reverse?'⬆':'⬇')||''}}
                            <i class="ba__margin-horizontal-5"></i>
                        </div>
                        <div class="col-xs-2 text-center">
                            <i class="ba__margin-horizontal-5"></i>
                        </div>
                    </div>
                </a>
            </div>

            <div class="modal fade" id="cadastroLocal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog modal-localReservavel" role="document">
                    <div class="modal-content localReservavel-content">
                        <div class="modal-header localReservavel-header">
                            <div class="row">
                                <h4 class="modal-title Roboto-Thin ba__font-size-25" style="padding: 31px 50px 10px; font-weight: bold;">
                                    <i class="icon-ba-building text-center text-primary ba__margin-horizontal-5 icon-modal-title"></i>
                                    <span>{{ data.contaPagarSelecionado.id ? 'Editar local reservável' : 'Novo local reservável'}}</span>
                                </h4>
                            </div>
                            <div class="row checkPassosLocal">
                                <span class="col-sm-7 col-sm-offset-1"><h4><b ng-class="{'step-selecionado': step == 1}" ng-click="goStep(1)">1</b> Dados Gerais</h4></span>
                                <span class="col-sm-7 col-sm-offset-1"><h4><b ng-class="{'step-selecionado': step == 2}" ng-click="goStep(2)">2</b> Parametrizações</h4></span>
                                <span class="col-sm-6 col-sm-offset-2"><h4><b ng-class="{'step-selecionado': step == 3}" ng-click="goStep(3)">3</b> Período</h4></span>
                            </div>
                        </div>
                        <div class="modal-body ba__modal-body-tipo-lancamento">
                            <form>
                                <div class="row">
                                    <!--STEP DADOS GERAIS-->
                                    <div class="form-group col-xs-24 ba__margin-top-20" id="step1" ng-show="step === 1">
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-4">
                                                <h5 class="text-right text-gray">Localidade</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <select class="ba__input-select" ng-model="localReservavel.idLocalidade"
                                                        ng-options="localidade.id as localidade.descricao for localidade in localidades"
                                                        enter>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-4">
                                                <h5 class="text-right text-gray">Nome do local</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <input type="text" class="ba__input-modal" maxlength="90" style="text-transform:uppercase" ng-model="data.contaPagarSelecionado.descricao"
                                                       required>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-4">
                                                <h5 class="text-right text-gray">Descrição</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <textarea class="ba__input-modal"></textarea>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-4">
                                                <h5 class="text-right text-gray">Capacidade</h5>
                                            </div>
                                            <div class="col-md-1 col-md-offset-1 ba__margin-right-20">
                                                <div class="onoffswitch">
                                                    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="capacidade" checked enter ng-model="localReservavel.capacidade">
                                                    <label class="onoffswitch-label" for="capacidade">
                                                        <span class="onoffswitch-inner"></span>
                                                        <span class="onoffswitch-switch"></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <p ng-if="!localReservavel.capacidade" class="col-md-6 ba__margin-left-10 ba__font-size-15">sem limite definido</p>
                                            <div ng-if="localReservavel.capacidade" class="col-md-18 col-md-offset-1 ba__margin-top-10">
                                                <i class="fa fa-minus-circle ba__font-size-25 pull-left" style="padding-top: 10px"></i>
                                                <input type="text" class="ba__input-modal limite-pessoas">
                                                <i class="icon-ba-plus ba__font-size-25 pull-left" style="padding-top: 10px"></i>
                                                <span class="label_pessoa">pessoas</span>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-3">
                                                <h5 class="text-right text-gray">Regras de Utilização</h5>
                                            </div>
                                            <div class="col-md-19 col-md-offset-2">
                                                <!--<button class="btn btn-default pull-left ba__margin-right-15">ANEXAR ARQUIVO</button>-->
                                                <input class="ba__font-size-12" type="file" ng-model="localReservavel.regras" onchange="angular.element(this).scope()">
                                                <span class="col-md-14 ba__font-size-12 ba__font-color-gray ba__margin-top-10" >Arquivos de no max 10MB, nas extensões .PDF, .DOC, .DOCX, .XLS, .XLSX, .JPG ou .TXT</span>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-4">
                                                <h5 class="text-right text-gray">Imagem do local</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <input type="file" id="inputFoto" style="display: none" ng-model="localReservavel.fotos" onchange="angular.element(this).scope()">
                                                <div class="input-group">
                                                    <span style="display: inline-flex">
                                                        <img src="img/avatar.png" ng-click="addFotoLocal()" class="img-local">
                                                        <img src="img/avatar.png" class="img-local">
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--STEP PARAMETRIZAÇÕES-->
                                    <div class="form-group col-xs-24" id="step2" ng-show="step === 2">

                                        <div class="row ba__margin-top-15">
                                            <div class="col-md-6">
                                                <div class="col-xs-7 pull-right">
                                                    <div class="onoffswitch">
                                                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" enter ng-model="data.acrescimoObj.incluir_soma" id="incluirSoma">
                                                        <label class="onoffswitch-label" for="incluirSoma">
                                                            <span class="onoffswitch-inner" ng-show="data.acrescimoObj.incluir_soma"></span>
                                                            <span class="onoffswitch-switch" ng-show="!data.acrescimoObj.incluir_soma"></span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-14 col-md-offset-1">
                                                <h5 class="text-gray" style="margin-top: 0">Deixar visível os dados de quem reservou para os outros usuários (somente nome e unidade)</h5>
                                            </div>
                                        </div>

                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Número do documento</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <input type="text" class="ba__input-modal" style="text-transform:uppercase" ng-model="data.contaPagarSelecionado.numero_nf"
                                                       placeholder="">
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Data de emissão do documento</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <input type="date" class="ba__input-modal" ng-model="data.contaPagarSelecionado.data_emissao_nf" />
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Localização*</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <div class="input-group">
                                                    <select class="ba__input-select" ng-model="data.contaPagarSelecionado.id_localizacao" enter ng-options="localidade.id as localidade.descricao for localidade in localidades">
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Departamento*</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <div class="input-group">
                                                    <select class="ba__input-select" ng-model="data.contaPagarSelecionado.id_departamento" enter ng-options="departamento.id as departamento.descricao for departamento in departamentos">
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Observação</h5>
                                            </div>
                                            <div class="col-md-10 col-md-offset-1">
                                                <input type="text" class="ba__input-modal" style="text-transform:uppercase" ng-model="data.contaPagarSelecionado.observacao"
                                                       placeholder="">
                                            </div>
                                        </div>
                                    </div>
                                    <!--STEP PERÍODOS-->
                                    <div class="form-group col-xs-24" id="step3" ng-show="step === 3">
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Grupo de conta</h5>
                                            </div>
                                            <div class="col-md-12 col-md-offset-1">
                                                <div class="input-group">
                                                    <select class="ba__input-select" ng-model="data.acrescimoObj.id_grupo_lancamento" ng-change="filterPC2(data.acrescimoObj.id_grupo_lancamento)"
                                                            ng-options="grp.id as grp.descricao for grp in grupoLancamentos">
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Tipo de lançamento</h5>
                                            </div>
                                            <div class="col-md-7 col-md-offset-1">
                                                <div class="input-group">
                                                    <select class="ba__input-select" ng-model="data.acrescimoObj.id_tipo_lancamento" enter ng-options="planoConta2.id as planoConta2.descricao for planoConta2 in planoContas2">
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Valor</h5>
                                            </div>
                                            <div class="col-md-7 col-md-offset-1">
                                                <input type="text" class="ba__input-modal" ui-money-mask style="text-transform:uppercase" ng-model="data.acrescimoObj.valor"
                                                       placeholder="R$ 34,34">
                                            </div>
                                        </div>
                                        <div class="row ba__margin-bottom-30">
                                            <div class="col-md-6">
                                                <h5 class="text-right text-gray">Incluir soma</h5>
                                            </div>
                                            <div class="col-md-2 col-md-offset-1 ba__margin-top-5">
                                                <div class="col-xs-7 ba__margin-left-5">
                                                    <div class="onoffswitch">
                                                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" enter ng-model="data.acrescimoObj.incluir_soma" id="incluirSoma">
                                                        <label class="onoffswitch-label" for="incluirSoma">
                                                            <span class="onoffswitch-inner" ng-show="data.acrescimoObj.incluir_soma"></span>
                                                            <span class="onoffswitch-switch" ng-show="!data.acrescimoObj.incluir_soma"></span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <h5 class="col-xs-3" style="margin-left: -40px">
                                            <span class="pull-left">
                                                <span ng-show="data.acrescimoObj.incluir_soma" class="text-positive">SIM</span>
                                                <span ng-show="!data.acrescimoObj.incluir_soma">NÃO</span>
                                            </span>
                                            </h5>
                                        </div>
                                        <button type="button" ng-click="adicionarTaxa()" ng-disabled="(data.acrescimoObj.valor == '')||(data.acrescimoObj.valor == 0)||(!data.acrescimoObj.id_tipo_lancamento)"
                                                class="btn btn-success col-md-4 col-md-offset-7" style="margin-top: -15px; margin-bottom: 20px">
                                            Adicionar débito
                                        </button>

                                        <div class="row ba__admin-list">
                                            <div class="list-group ba__admin-table ba__margin-top-20 col-md-24" style="height: 65%; overflow: hidden">
                                                <a class="list-group-item disabled col-md-24">
                                                    <div class="row uppercase">
                                                        <div class="col-xs-12">Tipo de lançamento
                                                            <i class="ba__margin-horizontal-5"></i>
                                                        </div>
                                                        <div class="col-xs-6">Valor
                                                            <i class="ba__margin-horizontal-5"></i>
                                                        </div>
                                                        <div class="col-xs-3">Incluir soma
                                                            <i class="ba__margin-horizontal-5"></i>
                                                        </div>
                                                        <div class="col-xs-2">
                                                            <i class="ba__margin-horizontal-5"></i>
                                                        </div>
                                                    </div>
                                                </a>
                                                <div class="ba__admin-table-scroll col-md-24" style="overflow: auto">
                                                    <a class="list-group-item ba__font-size-12" style="height: auto" ng-repeat="acrescimoSelecionado in data.acrescimosSelecionado"
                                                       ng-show="acrescimoSelecionado.deleted == 0">
                                                        <div class="row">
                                                            <div class="col-xs-12">
                                                                <div class="col-xs-20">
                                                                    <span>{{getNamePlanoConta(acrescimoSelecionado)}}</span>
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-6">
                                                                <div class="col-xs-20">
                                                                    <span>{{acrescimoSelecionado.valor | currency}}</span>
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-3">
                                                                <div class="col-xs-20">
														<span class="pull-left">
															<span ng-show="acrescimoSelecionado.incluir_soma" class="text-positive">SIM</span>
															<span ng-show="!acrescimoSelecionado.incluir_soma">NÃO</span>
														</span>
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-2">
                                                                <i class="icon-ba-trash text-gray-medium ba__margin-left-15" ng-click="excluirTaxa($index)"></i>
                                                                <input type="hidden" ng-model="acrescimoSelecionado.deleted" ng-init="acrescimoSelecionado.deleted=0" />
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer" style="margin: 20px">
                            <button type="button" class="btn btn-success col-md-5 col-md-offset-1 pull-right" ng-show="step == 3"
                                    ng-click="salvar()">
                                Concluir
                            </button>
                            <button type="button" ng-click="goStep('+')" class="btn btn-success col-md-5 col-md-offset-1 pull-right" ng-show="step < 3">
                                Próximo passo
                            </button>
                            <button type="button" ng-click="goStep('-')" class="btn btn-default col-md-5 pull-right" ng-show="step > 1">
                                Voltar
                            </button>
                            <button type="button" class="btn btn-default btn-clear col-md-5 pull-right" ng-click="fecharModalLocalReserva()">
                                Cancelar
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>